<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Explorerâ€™s Reward</title>
<link rel="stylesheet" href="/assets/css/style.css">
</head>
<body class="wrap center">
  <h2>Keep scrollingâ€¦</h2>
  <div style="height:2000px"></div>
  <a id="claim" class="btn">ðŸŽ‰ Claim Bonus</a>

<script>
  const p = new URLSearchParams(location.search);
  let group = p.get('group');
  const tag = p.get('tag');

  if (!group) {
    group = localStorage.getItem('treasure_group');
    if (!group) {
      // Redirect to set group page, then return here
      const returnUrl = location.pathname + location.search;
      location.href = '/setgroup.html?return=' + encodeURIComponent(returnUrl);
    }
  }

  const app = "{{APP_SCRIPT_URL}}"; // Replace or inject via env
  const url = new URL(app || "https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec");
  url.searchParams.set("group", group);
  url.searchParams.set("tag", tag);
  url.searchParams.set("bonus", "scroll");

  document.getElementById('claim').onclick = () => location.href = url.toString();
</script>
</body>
</html>
